<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of phy_setMothers</title>
  <meta name="keywords" content="phy_setMothers">
  <meta name="description" content="Based on the geometrical overlap of budnecks and cells, this function">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- # phyloCell -->
<h1>phy_setMothers
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Based on the geometrical overlap of budnecks and cells, this function</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [tcells tbudnecks]=phy_setMothers(tcells,tbudnecks,cell,firstMCell,firstCells) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">Based on the geometrical overlap of budnecks and cells, this function
creates the pylogenie, it sets the mothers to the coresponding cells</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="phyloCell_mainGUI.html" class="code" title="function varargout = phyloCell_mainGUI(varargin)">phyloCell_mainGUI</a>	Main graphical user interface;</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%Based on the geometrical overlap of budnecks and cells, this function</span>
0002 <span class="comment">%creates the pylogenie, it sets the mothers to the coresponding cells</span>
0003 
0004 
0005 <a name="_sub0" href="#_subfunctions" class="code">function [tcells tbudnecks]=phy_setMothers(tcells,tbudnecks,cell,firstMCell,firstCells)</a>
0006 
0007 tcells(firstMCell).setMother(firstMCell);
0008 
0009 <span class="keyword">for</span> i=firstCells
0010     tcells(i).setMother(firstMCell);
0011     tcells(i).birthFrame=0;
0012     tcells(firstMCell).removeDaughter(i);
0013     tcells(firstMCell).addDaughter(i,0,0);
0014 <span class="keyword">end</span>
0015 
0016 <span class="keyword">for</span> i=1:length(tbudnecks) <span class="comment">% pour chaque budneck</span>
0017     <span class="keyword">if</span> length(tbudnecks(i).Obj)&gt;=5
0018         ovrcells=[];
0019         <span class="keyword">for</span> j=1:length(tbudnecks(i).Obj)
0020             ovrcells=[ovrcells;tbudnecks(i).Obj(j).(cell)];
0021         <span class="keyword">end</span>
0022         nr_pix=[];
0023         nr_cell=[];
0024         daughtercell=1;
0025         mothercell=1;
0026         [nr_pix,nr_cell] = hist(ovrcells,0:max(ovrcells));<span class="comment">% hitogram of overlaping cells1; scale from 0 to cells1 max</span>
0027         nr_pix=nr_pix(2:end);<span class="comment">% eliminate the case of no overlapping (case of background 0);</span>
0028         nr_cell=nr_cell(2:end);
0029         [B,IX] = sort(nr_pix,<span class="string">'descend'</span>); <span class="comment">%sort descending by feqency</span>
0030         <span class="keyword">if</span> numel(B)&gt;=1
0031             <span class="keyword">if</span> B(1)~=0
0032                 mothercell=IX(1); <span class="comment">% the most freqent cell on budneck n</span>
0033             <span class="keyword">end</span>
0034         <span class="keyword">end</span>
0035         motherSetted=false;
0036         <span class="keyword">if</span> numel(B)&gt;1   <span class="comment">% a length test for the case of cells1 =1 with no other corespondance;</span>
0037             freqorder=1;
0038             
0039             <span class="keyword">while</span> (~motherSetted) &amp;&amp;(freqorder&lt;length(IX))
0040                     freqorder=freqorder+1;
0041                     <span class="keyword">if</span> B(freqorder)~=0
0042                         daughtercell=IX(freqorder);
0043                         motherSetted=tcells(daughtercell).setMother(mothercell);
0044                         <span class="comment">%second most freqent valid cell on budneck n</span>
0045                         <span class="keyword">if</span> (freqorder==2)&amp;&amp;(~motherSetted)
0046                             motherSetted=tcells(mothercell).setMother(daughtercell); <span class="comment">%try to set a valid correspondence mother-daughter</span>
0047                             <span class="keyword">if</span> motherSetted
0048                                 aux=mothercell;
0049                                 mothercell=daughtercell;
0050                                 daughtercell=aux;
0051                             <span class="keyword">end</span>
0052                             <span class="comment">%change the order(the most freqent part of the butneck is on the daughter cell not on the mother cell)</span>
0053                         <span class="keyword">end</span>
0054                     <span class="keyword">else</span>
0055                         <span class="keyword">break</span>;
0056                     <span class="keyword">end</span>
0057             <span class="keyword">end</span>
0058             
0059         <span class="keyword">end</span>
0060         
0061         <span class="keyword">if</span> motherSetted
0062             <span class="comment">%if a valid corespondence</span>
0063             tbudnecks(i).setMother(mothercell); <span class="comment">%associates mother cell with budneck</span>
0064             tbudnecks(i).addDaughter(daughtercell);<span class="comment">%associates daughter cell with budneck</span>
0065             divisionStart=tbudnecks(i).detectionFrame;
0066             divisionEnd=tbudnecks(i).lastFrame;
0067             tcells(mothercell).addDaughter(daughtercell,divisionStart,divisionEnd); <span class="comment">%add a new daughter to the mother</span>
0068             tcells(daughtercell).birthFrame=divisionEnd; <span class="comment">%set the birth equal as endDivision time</span>
0069         <span class="keyword">end</span>
0070             
0071         
0072     <span class="keyword">end</span>
0073 <span class="keyword">end</span>
0074 tcells(firstMCell).setMother(0,0);<span class="comment">% set mother from frame 0 to 0 (does not clear the daugther list)</span></pre></div>
<hr><address>Generated on Wed 27-Oct-2010 20:01:59 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>