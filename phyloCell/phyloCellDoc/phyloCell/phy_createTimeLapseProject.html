<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of phy_createTimeLapseProject</title>
  <meta name="keywords" content="phy_createTimeLapseProject">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- # phyloCell -->
<h1>phy_createTimeLapseProject
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function phy_createTimeLapseProject(tempProject) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="phy_createTimeLapseDirectory.html" class="code" title="function phy_createTimeLapseDirectory()">phy_createTimeLapseDirectory</a>	</li><li><a href="phy_openProject.html" class="code" title="function phy_openProject(inp)">phy_openProject</a>	</li><li><a href="phy_saveProject.html" class="code" title="function phy_saveProject(pathname,filename)">phy_saveProject</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="phy_createTimeLapseProjectGui.html" class="code" title="function varargout = phy_createTimeLapseProjectGui(varargin)">phy_createTimeLapseProjectGui</a>	create time lapse project from images</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function phy_createTimeLapseProject(tempProject)</a>
0002 <span class="keyword">global</span> timeLapse;
0003 <span class="keyword">global</span> position;
0004 <span class="keyword">global</span> overlay; 
0005 <span class="keyword">global</span> overlayList;
0006 
0007 
0008 timeLapse=[];
0009 timeLapse.numberOfFrames=numel(tempProject.imageList(1).data);
0010 timeLapse.currentFrame=numel(tempProject.imageList(1).data);
0011 timeLapse.interval=180;
0012 timeLapse.sequencer=[];
0013 timeLapse.seqFrame=[];
0014 
0015 timeLapse.path=tempProject.path;
0016 timeLapse.filename=tempProject.filename;
0017 timeLapse.realPath=timeLapse.path;
0018 timeLapse.realName=timeLapse.filename;
0019 timeLapse.startedDate=datestr(now);
0020 timeLapse.startedClock=clock;
0021  
0022 timeLapse.comments=<span class="string">'This project was generated using createTimeLapseProject'</span>;
0023 
0024 <span class="comment">%timeLapse.strainName=get(handles.setStrainName,'String');</span>
0025 <span class="comment">%timeLapse.genotype=get(handles.setGenotype,'String');</span>
0026 <span class="comment">%timeLapse.goal=get(handles.setGoal,'String');</span>
0027 <span class="comment">%timeLapse.movieType={'Flow-Cell'};</span>
0028 
0029 timeLapse.analysis.segmentTimeLapseImages=tempProject.segment;
0030 timeLapse.analysis.setPhaseChannel=tempProject.phaseChannel;
0031 
0032 
0033 timeLapse.analysis.segmentBudNeck=tempProject.budsegment;
0034 <span class="keyword">if</span> timeLapse.analysis.segmentBudNeck
0035 timeLapse.analysis.setBudNeckChannel=tempProject.budChannel;
0036 <span class="keyword">else</span>
0037     timeLapse.analysis.setBudNeckChannel=0;
0038 <span class="keyword">end</span>
0039 
0040 timeLapse.analysis.makeImageRetreat=tempProject.retreat;
0041 
0042 timeLapse.status=<span class="string">'done'</span>;
0043 
0044 
0045 
0046 <span class="keyword">for</span> i=1:tempProject.channel
0047 timeLapse.list(i).ID=<span class="string">''</span>;
0048 sourcefile=strcat(tempProject.pathList(i).data,cell2mat(tempProject.imageList(i).data(1)));
0049 info=imfinfo(sourcefile);
0050 timeLapse.list(i).videoResolution(1)=info.Width;
0051 timeLapse.list(i).videoResolution(2)=info.Height;
0052 <span class="keyword">if</span> i==tempProject.phaseChannel
0053 timeLapse.list(i).phaseFluo=2;
0054 <span class="keyword">else</span>
0055 timeLapse.list(i).phaseFluo=5;    
0056 <span class="keyword">end</span>
0057 timeLapse.list(i).setLowLevel=0;
0058 timeLapse.list(i).setHighLevel=0;
0059 timeLapse.list(i).filterCube=i+1;
0060 <span class="keyword">end</span>
0061 
0062 <span class="keyword">for</span> i=1:tempProject.position
0063 position.list(i).name=<span class="string">''</span>;
0064 position.list(i).timeLapse.list=timeLapse.list;
0065 
0066 <span class="keyword">end</span>
0067 
0068 timeLapse.position=position;
0069 
0070 <span class="comment">%cd(timeLapse.realPath);</span>
0071 
0072 <a href="phy_createTimeLapseDirectory.html" class="code" title="function phy_createTimeLapseDirectory()">phy_createTimeLapseDirectory</a>();
0073 
0074 <a href="phy_saveProject.html" class="code" title="function phy_saveProject(pathname,filename)">phy_saveProject</a>(timeLapse.path,<span class="string">'BK-project.mat'</span>);
0075 <a href="phy_saveProject.html" class="code" title="function phy_saveProject(pathname,filename)">phy_saveProject</a>(timeLapse.path,[timeLapse.filename <span class="string">'-project.mat'</span>]);
0076 
0077 
0078 maxpos=numel(timeLapse.position.list);
0079    
0080 <span class="comment">%methodsel=5;</span>
0081 <span class="comment">%       if (isScope('DMI6000B'))</span>
0082 <span class="comment">%           methodsel=5;</span>
0083 <span class="comment">%       else</span>
0084 <span class="comment">%           methodsel=2;</span>
0085 <span class="comment">%       end</span>
0086 
0087 fprintf(<span class="string">'Saving images to appropriate dir'</span>);
0088  n=1;      
0089 <span class="keyword">for</span> i=1:maxpos
0090     fprintf([<span class="string">'\n entering position : '</span> num2str(i) <span class="string">'/'</span> num2str(maxpos)]);
0091     dirpos=strcat(timeLapse.filename,<span class="string">'-pos'</span>,int2str(i));
0092     localTimeLapse=timeLapse;
0093        
0094     <span class="keyword">for</span> j=1:numel(localTimeLapse.list)
0095         fprintf([<span class="string">'\n entering channel : '</span> num2str(j) <span class="string">'/'</span> num2str(numel(localTimeLapse.list))]);
0096         
0097         chpos=strcat(timeLapse.filename,<span class="string">'-pos'</span>,int2str(i),<span class="string">'-ch'</span>,int2str(j),<span class="string">'-'</span>,localTimeLapse.list(j).ID); 
0098         
0099         path2=strcat(timeLapse.path,dirpos,<span class="string">'/'</span>);
0100         fullpath=strcat(path2,chpos,<span class="string">'/'</span>);
0101         
0102         <span class="keyword">for</span> k=1:timeLapse.numberOfFrames
0103           fprintf(<span class="string">'.'</span>);
0104         framenumber=num2str(k);
0105         frame=framenumber;
0106         <span class="keyword">for</span> jk=1:3  
0107            <span class="keyword">if</span> (numel(framenumber)&lt;3)
0108                framenumber=strcat(<span class="string">'0'</span>,framenumber);
0109            <span class="keyword">end</span>
0110         <span class="keyword">end</span>
0111            
0112        
0113         sourcefile=strcat(tempProject.pathList(n).data,cell2mat(tempProject.imageList(n).data(k)));
0114         
0115         [pathstr, name, ext, versn] = fileparts(sourcefile);
0116         
0117         <span class="keyword">if</span> strcmp(ext,<span class="string">'.jpg'</span>)
0118        destination=strcat(fullpath,timeLapse.filename,<span class="string">'-pos'</span>,int2str(i),<span class="string">'-ch'</span>,int2str(j),<span class="string">'-'</span>,localTimeLapse.list(j).ID,<span class="string">'-'</span>,framenumber,<span class="string">'.jpg'</span>);
0119        str2=strcat(timeLapse.filename,<span class="string">'-pos'</span>,int2str(i),<span class="string">'-ch'</span>,int2str(j),<span class="string">'-'</span>,localTimeLapse.list(j).ID,<span class="string">'-'</span>,framenumber,<span class="string">'.jpg'</span>);
0120         <span class="keyword">else</span>
0121         destination=strcat(fullpath,timeLapse.filename,<span class="string">'-pos'</span>,int2str(i),<span class="string">'-ch'</span>,int2str(j),<span class="string">'-'</span>,localTimeLapse.list(j).ID,<span class="string">'-'</span>,framenumber,<span class="string">'.jpg'</span>);
0122        str2=strcat(timeLapse.filename,<span class="string">'-pos'</span>,int2str(i),<span class="string">'-ch'</span>,int2str(j),<span class="string">'-'</span>,localTimeLapse.list(j).ID,<span class="string">'-'</span>,framenumber,<span class="string">'.jpg'</span>);    
0123         <span class="keyword">end</span>
0124         copyfile(sourcefile,destination);
0125       
0126       <span class="comment">% imwrite(tempi,str,'BitDepth',12,'Mode','lossless');</span>
0127        
0128        
0129        list=strcat(fullpath,timeLapse.filename,<span class="string">'-pos'</span>,int2str(i),<span class="string">'-ch'</span>,int2str(j),<span class="string">'-'</span>,localTimeLapse.list(j).ID,<span class="string">'-list.txt'</span>);
0130        
0131        <span class="keyword">if</span> (k~=1)
0132        dlmwrite(list, str2,<span class="string">'-append'</span>,<span class="string">'delimiter'</span>,<span class="string">''</span>);
0133        <span class="keyword">else</span>
0134        dlmwrite(list, str2,<span class="string">'delimiter'</span>,<span class="string">''</span>);   
0135        <span class="keyword">end</span>
0136        
0137     
0138         <span class="keyword">end</span>
0139     n=n+1;
0140 <span class="keyword">end</span>
0141 <span class="keyword">end</span>
0142 
0143 <span class="keyword">if</span> timeLapse.analysis.makeImageRetreat
0144    retreatMovieImages(timeLapse.analysis.setPhaseChannel);
0145 <span class="keyword">end</span>
0146 
0147 <a href="phy_saveProject.html" class="code" title="function phy_saveProject(pathname,filename)">phy_saveProject</a>(timeLapse.path,<span class="string">'BK-project.mat'</span>);
0148 <a href="phy_saveProject.html" class="code" title="function phy_saveProject(pathname,filename)">phy_saveProject</a>(timeLapse.path,[timeLapse.filename <span class="string">'-project.mat'</span>]);
0149 
0150 <span class="keyword">if</span> timeLapse.analysis.segmentTimeLapseImages
0151      segmentTimeLapseImages(timeLapse.analysis.setPhaseChannel);   
0152 <span class="keyword">end</span>
0153 
0154 <a href="phy_saveProject.html" class="code" title="function phy_saveProject(pathname,filename)">phy_saveProject</a>(timeLapse.path,<span class="string">'BK-project.mat'</span>);
0155 <a href="phy_saveProject.html" class="code" title="function phy_saveProject(pathname,filename)">phy_saveProject</a>(timeLapse.path,[timeLapse.filename <span class="string">'-project.mat'</span>]);
0156 
0157 overlay=[];
0158 overlayList=[];
0159 <a href="phy_openProject.html" class="code" title="function phy_openProject(inp)">phy_openProject</a>([timeLapse.path timeLapse.filename <span class="string">'-project.mat'</span>]);
0160 
0161 
0162 <span class="keyword">if</span> tempProject.makemovie
0163    makeTimeLapseOverlayMovies(); 
0164 <span class="keyword">end</span>
0165 
0166</pre></div>
<hr><address>Generated on Wed 27-Oct-2010 20:01:59 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>