<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of phy_removeCellOverlap</title>
  <meta name="keywords" content="phy_removeCellOverlap">
  <meta name="description" content="remove overlap cells">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- # phyloCell -->
<h1>phy_removeCellOverlap
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>remove overlap cells</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [xnew1 ynew1 xnew2 ynew2]=phy_removeCellOverlap(x1,y1,x2,y2) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">remove overlap cells</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="phy_selfAvoding.html" class="code" title="function cellout=phy_selfAvoding(cells)">phy_selfAvoding</a>	separates the overlapping cells (from ball model)</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [xnew1 ynew1]=moveBadPoints(tes1,x1,y1)</a></li></ul>
<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">%remove overlap cells</span>
0002 
0003 <a name="_sub0" href="#_subfunctions" class="code">function [xnew1 ynew1 xnew2 ynew2]=phy_removeCellOverlap(x1,y1,x2,y2)</a>
0004 
0005 tes1 = inpolygon(x1,y1,x2,y2);
0006 tes2 = inpolygon(x2,y2,x1,y1);
0007 
0008 xnew1=x1;
0009 ynew1=y1;
0010 xnew2=x2;
0011 ynew2=y2;
0012 
0013 <span class="keyword">if</span> (mean(tes1)==0 &amp;&amp; mean(tes2)==0)
0014     <span class="keyword">return</span>;
0015 <span class="keyword">end</span>
0016 
0017 <span class="comment">%tes1,tes2</span>
0018 <span class="keyword">if</span> (mean(tes1)&lt;mean(tes2))
0019     
0020     [xnew1 ynew1]=<a href="#_sub1" class="code" title="subfunction [xnew1 ynew1]=moveBadPoints(tes1,x1,y1)">moveBadPoints</a>(tes1,x1,y1);
0021     cho=1;
0022    <span class="comment">% 'ok1'</span>
0023 <span class="keyword">else</span>
0024     [xnew2 ynew2]=<a href="#_sub1" class="code" title="subfunction [xnew1 ynew1]=moveBadPoints(tes1,x1,y1)">moveBadPoints</a>(tes2,x2,y2);
0025     cho=2;
0026    <span class="comment">% figure,plot(x1,y1,x2,y2,xnew2,ynew2);</span>
0027    <span class="comment">% 'ok2'</span>
0028 <span class="keyword">end</span>
0029 
0030 <span class="keyword">if</span> (cho==2)
0031 tes1 = inpolygon(xnew1,ynew1,xnew2,ynew2);
0032 
0033 <span class="keyword">if</span> (mean(tes1)~=0)
0034     [xnew1 ynew1]=<a href="#_sub1" class="code" title="subfunction [xnew1 ynew1]=moveBadPoints(tes1,x1,y1)">moveBadPoints</a>(tes1,x1,y1);   
0035 <span class="keyword">end</span>
0036 
0037 <span class="keyword">else</span>
0038     
0039 tes2 = inpolygon(xnew2,ynew2,xnew1,ynew1);
0040 
0041 <span class="keyword">if</span> (mean(tes2)~=0)
0042     [xnew2 ynew2]=<a href="#_sub1" class="code" title="subfunction [xnew1 ynew1]=moveBadPoints(tes1,x1,y1)">moveBadPoints</a>(tes2,x2,y2);   
0043 <span class="keyword">end</span>
0044 
0045 <span class="keyword">end</span>
0046 
0047 
0048 
0049 
0050 <a name="_sub1" href="#_subfunctions" class="code">function [xnew1 ynew1]=moveBadPoints(tes1,x1,y1)</a>
0051     
0052 first=0;
0053 ine=0;
0054 k=1;
0055 rep=0;
0056 indstart=[];
0057 indend=[];
0058 
0059 xnew1=x1;
0060 ynew1=y1;
0061 
0062 <span class="keyword">for</span> i=1:numel(x1)
0063    
0064    <span class="keyword">if</span> (i==1 &amp;&amp; tes1(i)==1)
0065      first=1;
0066      ine=1;
0067     <span class="comment">% 'ok1'</span>
0068    <span class="keyword">end</span>
0069    
0070    <span class="comment">%i,tes1(i),first</span>
0071    
0072    <span class="keyword">if</span> (tes1(i)==1 &amp;&amp; first==0)
0073       
0074        <span class="keyword">if</span> ine==0
0075           ine=1;
0076           indstart(k)=i-1;
0077        <span class="keyword">end</span>
0078        
0079        
0080    <span class="keyword">end</span>
0081    
0082    <span class="keyword">if</span> (tes1(i)==0 &amp;&amp; ine==1)
0083           <span class="keyword">if</span> (first==0)
0084           ine=0;
0085           <span class="keyword">if</span> i==numel(x1)
0086               t=1;
0087           <span class="keyword">else</span>
0088               t=i;
0089           <span class="keyword">end</span>
0090           indend(k)=t;   
0091           k=k+1;
0092           <span class="keyword">else</span>
0093           ine=0;
0094           rep=i;
0095           first=0;
0096          <span class="comment">% 'ok2'</span>
0097           <span class="keyword">end</span>
0098    <span class="keyword">end</span> 
0099      
0100 <span class="keyword">end</span>
0101 
0102 <span class="keyword">if</span> (rep~=0)
0103     <span class="keyword">if</span> tes1(1)==1
0104         indend(k)=rep; 
0105         <span class="comment">%'ok'</span>
0106     <span class="keyword">else</span>
0107         
0108     <span class="keyword">end</span>
0109 <span class="keyword">end</span>
0110 
0111  <span class="keyword">for</span> i=1:numel(indstart)
0112      tempx=[];
0113      tempy=[];
0114      
0115      istart=indstart(i);
0116      iend=indend(i);
0117 
0118      <span class="keyword">if</span>(iend&gt;istart)
0119      nb=iend-istart-1;
0120      <span class="keyword">else</span>
0121      nb=iend-1+numel(x1)-istart-1;
0122      nb1=numel(x1)-istart-1;
0123      <span class="keyword">end</span>
0124      
0125      diffx=x1(iend)-x1(istart);
0126      diffy=y1(iend)-y1(istart);
0127      
0128      tempx(1:nb)=x1(istart)+double(diffx*(1:1:nb))/double(nb);
0129      tempy(1:nb)=y1(istart)+double(diffy*(1:1:nb))/double(nb);
0130      
0131      <span class="keyword">if</span>(iend&gt;istart)
0132      xnew1(istart+1:iend-1)=tempx;
0133      ynew1(istart+1:iend-1)=tempy;
0134      <span class="keyword">else</span>
0135       
0136      xnew1(istart+1:numel(x1)-1)=tempx(1:nb1);
0137      ynew1(istart+1:numel(x1)-1)=tempy(1:nb1);  
0138      xnew1(1:nb-nb1)=tempx(nb1+1:nb);
0139      ynew1(1:nb-nb1)=tempy(nb1+1:nb); 
0140      <span class="comment">%xnew(istart+1:iend-1)=tempx;</span>
0141     <span class="comment">% indstart,indend,tempx,tempy,nb,nb1</span>
0142      
0143      xnew1(numel(x1))=xnew1(1);
0144      ynew1(numel(x1))=ynew1(1);
0145      <span class="keyword">end</span>
0146 
0147  <span class="keyword">end</span>
0148</pre></div>
<hr><address>Generated on Wed 27-Oct-2010 20:01:59 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>