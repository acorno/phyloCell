<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of phy_cell2csv</title>
  <meta name="keywords" content="phy_cell2csv">
  <meta name="description" content="Writes cell array content into a *.csv file.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- # phyloCell -->
<h1>phy_cell2csv
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Writes cell array content into a *.csv file.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function phy_cell2csv(datName,cellArray,seperator,excelVersion) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Writes cell array content into a *.csv file.
 
 CELL2CSV(datName,cellArray,seperator,excelVersion)

 datName      = Name of the file to save. [ i.e. 'text.csv' ]
 cellarray    = Name of the Cell Array where the data is in
 seperator    = seperating sign, normally:',' (it's default)
 excelVersion = depending on the Excel Version, the cells are put into
                quotes before added to the file (only numeric values)

         by Sylvain Fiedler, KA, 2004
 updated by Sylvain Fiedler, Metz, 06
 fixed the logical-bug, Kaiserslautern, 06/2008, S.Fiedler</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="phyloCell_mainGUI.html" class="code" title="function varargout = phyloCell_mainGUI(varargin)">phyloCell_mainGUI</a>	Main graphical user interface;</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function phy_cell2csv(datName,cellArray,seperator,excelVersion)</a>
0002 <span class="comment">% Writes cell array content into a *.csv file.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% CELL2CSV(datName,cellArray,seperator,excelVersion)</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% datName      = Name of the file to save. [ i.e. 'text.csv' ]</span>
0007 <span class="comment">% cellarray    = Name of the Cell Array where the data is in</span>
0008 <span class="comment">% seperator    = seperating sign, normally:',' (it's default)</span>
0009 <span class="comment">% excelVersion = depending on the Excel Version, the cells are put into</span>
0010 <span class="comment">%                quotes before added to the file (only numeric values)</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%         by Sylvain Fiedler, KA, 2004</span>
0013 <span class="comment">% updated by Sylvain Fiedler, Metz, 06</span>
0014 <span class="comment">% fixed the logical-bug, Kaiserslautern, 06/2008, S.Fiedler</span>
0015 
0016 <span class="keyword">if</span> seperator ~= <span class="string">''</span>
0017     seperator = <span class="string">','</span>;
0018 <span class="keyword">end</span>
0019 
0020 <span class="keyword">if</span> excelVersion &gt; 2000
0021     seperator = <span class="string">';'</span>;
0022 <span class="keyword">end</span>
0023 
0024 datei = fopen(datName,<span class="string">'w'</span>);
0025 
0026 <span class="keyword">for</span> z=1:size(cellArray,1)
0027     <span class="keyword">for</span> s=1:size(cellArray,2)
0028         
0029         var = eval(<span class="string">'cellArray(z,s)'</span>);
0030         
0031         <span class="keyword">if</span> size(var,1) == 0
0032             var = <span class="string">''</span>;
0033         <span class="keyword">end</span>
0034         
0035         <span class="keyword">if</span> isnumeric(var) == 1
0036             var = num2str(var);
0037         <span class="keyword">end</span>
0038         
0039         <span class="keyword">if</span> islogical(var) == 1
0040             <span class="keyword">if</span> var == 1
0041                 var = <span class="string">'TRUE'</span>;
0042             <span class="keyword">else</span>
0043                 var = <span class="string">'FALSE'</span>;
0044             <span class="keyword">end</span>
0045         <span class="keyword">end</span>
0046         
0047         <span class="keyword">if</span> excelVersion &gt; 2000
0048             var = [<span class="string">'&quot;'</span> var <span class="string">'&quot;'</span>];
0049         <span class="keyword">end</span>
0050         fprintf(datei,var);
0051         
0052         <span class="keyword">if</span> s ~= size(cellArray,2)
0053             fprintf(datei,seperator);
0054         <span class="keyword">end</span>
0055     <span class="keyword">end</span>
0056     fprintf(datei,<span class="string">'\n'</span>);
0057 <span class="keyword">end</span>
0058 fclose(datei);</pre></div>
<hr><address>Generated on Wed 27-Oct-2010 20:01:59 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>