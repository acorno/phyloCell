<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of phy_selfAvoding</title>
  <meta name="keywords" content="phy_selfAvoding">
  <meta name="description" content="separates the overlapping cells (from ball model)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- # phyloCell -->
<h1>phy_selfAvoding
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>separates the overlapping cells (from ball model)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function cellout=phy_selfAvoding(cells) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> separates the overlapping cells (from ball model)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="phy_changePointNumber.html" class="code" title="function [xnew ynew]=phy_changePointNumber(x,y,npoints)">phy_changePointNumber</a>	</li><li><a href="phy_getCellCenter.html" class="code" title="function [a b]=phy_getCellCenter(x,y)">phy_getCellCenter</a>	get the center of the cells</li><li><a href="phy_removeCellOverlap.html" class="code" title="function [xnew1 ynew1 xnew2 ynew2]=phy_removeCellOverlap(x1,y1,x2,y2)">phy_removeCellOverlap</a>	remove overlap cells</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="phy_segmentCellsBallon.html" class="code" title="function cellsout=phy_segmentCellsBallon(image,cellsin,option,killcells,parametres)">phy_segmentCellsBallon</a>	find cell center based on phase image using bwdist to detect cell centers and</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% separates the overlapping cells (from ball model)</span>
0002 <a name="_sub0" href="#_subfunctions" class="code">function cellout=phy_selfAvoding(cells)</a>
0003 <span class="keyword">global</span> cella;
0004 <span class="keyword">global</span> cellb;
0005 
0006 nx=cells.nx;
0007 
0008 cellout=cells;
0009 
0010 cella=cellout;
0011 
0012 <span class="keyword">for</span> i=1:cellout.n
0013     <span class="keyword">for</span> j=i+1:cellout.n
0014         
0015         dist=sqrt((cellout.ox(i)-cellout.ox(j))^2+(cellout.oy(i)-cellout.oy(j))^2);
0016         maxar=sqrt(max(cellout.area(i),cellout.area(j)));
0017         
0018         <span class="keyword">if</span> (dist&gt;2*maxar)
0019           
0020             <span class="keyword">continue</span>;
0021             
0022         <span class="keyword">end</span>
0023         
0024         s=i;
0025         x1=cellout.x((s-1)*(nx+1)+1:(s)*(nx+1));
0026         y1=cellout.y((s-1)*(nx+1)+1:(s)*(nx+1));
0027         
0028         s=j;
0029         x2=cellout.x((s-1)*(nx+1)+1:(s)*(nx+1));
0030         y2=cellout.y((s-1)*(nx+1)+1:(s)*(nx+1));
0031         
0032         [xnew1 ynew1 xnew2 ynew2]=<a href="phy_removeCellOverlap.html" class="code" title="function [xnew1 ynew1 xnew2 ynew2]=phy_removeCellOverlap(x1,y1,x2,y2)">phy_removeCellOverlap</a>(x1,y1,x2,y2);
0033         [xnew1 ynew1]=<a href="phy_changePointNumber.html" class="code" title="function [xnew ynew]=phy_changePointNumber(x,y,npoints)">phy_changePointNumber</a>(xnew1,ynew1,nx);
0034         [xnew2 ynew2]=<a href="phy_changePointNumber.html" class="code" title="function [xnew ynew]=phy_changePointNumber(x,y,npoints)">phy_changePointNumber</a>(xnew2,ynew2,nx);
0035         
0036         s=i;
0037         <span class="keyword">if</span> (numel(xnew1)~=nx+1 || numel(ynew1)~=nx+1)
0038             xnew1=x1;
0039             ynew1=y1;
0040         <span class="keyword">else</span>
0041             cellout.x((s-1)*(nx+1)+1:(s)*(nx+1))=xnew1;
0042             cellout.y((s-1)*(nx+1)+1:(s)*(nx+1))=ynew1;
0043         <span class="keyword">end</span>
0044         
0045         s=j;
0046         <span class="keyword">if</span> (numel(xnew2)~=nx+1 || numel(ynew2)~=nx+1)
0047             xnew2=x2;
0048             ynew2=y2;
0049         <span class="keyword">else</span>
0050             cellout.x((s-1)*(nx+1)+1:(s)*(nx+1))=xnew2;
0051             cellout.y((s-1)*(nx+1)+1:(s)*(nx+1))=ynew2;
0052         <span class="keyword">end</span>
0053         
0054     <span class="keyword">end</span>
0055 <span class="keyword">end</span>
0056 
0057 <span class="keyword">for</span> i=1:cellout.n   
0058      x=cellout.x((i-1)*(nx+1)+1:(i)*(nx+1));
0059      y=cellout.y((i-1)*(nx+1)+1:(i)*(nx+1));
0060      [cellout.ox(i) cellout.oy(i)]=<a href="phy_getCellCenter.html" class="code" title="function [a b]=phy_getCellCenter(x,y)">phy_getCellCenter</a>(x,y);
0061      cellout.area(i)=round(polyarea(x,y));
0062 <span class="keyword">end</span>
0063 
0064 cellb=cellout;</pre></div>
<hr><address>Generated on Wed 27-Oct-2010 20:01:59 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>